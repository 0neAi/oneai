<!DOCTYPE HTML>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <title>1ai মার্চেন্ট সাপোর্ট</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="./assets/css/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* Reuse dashboard styling */
    :root {
      --primary-color: #1cb495;
      --secondary-color: #6f42c1;
      --dark-bg: rgba(30, 30, 45, 0.95);
      --card-bg: rgba(40, 40, 60, 0.5);
      --success-color: #28a745;
      --warning-color: #ffc107;
      --danger-color: #dc3545;
    }
    
    body {
      background-color: #0a0a15;
      color: #f0f0f0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      color: var(--primary-color);
      text-shadow: 0 0 10px rgba(28, 180, 149, 0.3);
    }
    
    .section {
      background: var(--dark-bg);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    
    .section-title {
      font-size: 1.8rem;
      margin-top: 0;
      margin-bottom: 1.5rem;
      color: var(--primary-color);
      display: flex;
      align-items: center;
    }
    
    .section-title i {
      margin-right: 10px;
    }
    
    .merchant-list-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    
    .merchant-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 1.5rem;
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .merchant-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      border-color: var(--primary-color);
    }
    
    .merchant-card h3 {
      margin-top: 0;
      display: flex;
      align-items: center;
    }
    
    .merchant-card .status {
      display: inline-block;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.85rem;
      margin-left: 10px;
    }
    
    .status.issueless {
      background: rgba(40, 167, 69, 0.2);
      color: #28a745;
    }
    
    .status.issue {
      background: rgba(220, 53, 69, 0.2);
      color: #dc3545;
    }
    
    .merchant-card ul {
      padding-left: 1.5rem;
      margin-bottom: 0;
    }
    
    .merchant-card li {
      margin-bottom: 0.5rem;
      position: relative;
    }
    
    .merchant-card li:before {
      content: "•";
      color: var(--primary-color);
      position: absolute;
      left: -1.2rem;
      font-size: 1.2rem;
    }
    
    .form-group {
      margin-bottom: 1.5rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
      color: var(--primary-color);
    }
    
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
      transition: all 0.3s ease;
      font-size: 1rem;
    }
    
    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(28, 180, 149, 0.3);
    }
    
    .form-row {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .form-row .form-group {
      flex: 1;
      margin-bottom: 0;
    }
    
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px 24px;
      background: linear-gradient(135deg, var(--primary-color) 0%, #168a70 100%);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
      text-align: center;
      font-size: 1rem;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, var(--secondary-color) 0%, #5a2d91 100%);
    }
    
    .btn-secondary:hover {
      background: linear-gradient(135deg, #5a2d91 0%, #4a2477 100%);
    }
    
    .btn-full {
      width: 100%;
    }
    
    .alert {
      padding: 15px;
      border-radius: 4px;
      margin: 15px 0;
    }
    
    .alert-success {
      background: rgba(40, 167, 69, 0.2);
      border: 1px solid rgba(40, 167, 69, 0.3);
      color: #28a745;
    }
    
    .alert-error {
      background: rgba(220, 53, 69, 0.2);
      border: 1px solid rgba(220, 53, 69, 0.3);
      color: #dc3545;
    }
    
    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    
    /* Confirmation message animations */
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    
    .confirmation-message {
      animation: slideIn 0.5s ease forwards;
      padding: 15px;
      border-radius: 5px;
      margin: 15px 0;
      display: flex;
      align-items: center;
    }
    
    .fade-out {
      animation: fadeOut 1s ease forwards;
    }
    
    .confirmation-success {
      background-color: rgba(40, 167, 69, 0.2);
      border: 1px solid rgba(40, 167, 69, 0.3);
      color: #28a745;
    }
    
    .confirmation-error {
      background-color: rgba(220, 53, 69, 0.2);
      border: 1px solid rgba(220, 53, 69, 0.3);
      color: #dc3545;
    }
    
    .confirmation-icon {
      margin-right: 10px;
      font-size: 1.2rem;
    }
    
    /* Voucher styles */
    .voucher-container {
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      border: 2px dashed gold;
    }
    
    .voucher-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .voucher-header h3 {
      margin: 0;
      color: gold;
    }
    
    .voucher-type {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: bold;
    }
    
    .voucher-type.issue {
      background-color: rgba(28, 180, 149, 0.2);
      color: var(--primary-color);
    }
    
    .voucher-type.penalty {
      background-color: rgba(111, 66, 193, 0.2);
      color: var(--secondary-color);
    }
    
    .voucher-code {
      font-size: 1.8rem;
      font-weight: bold;
      letter-spacing: 3px;
      text-align: center;
      margin: 15px 0;
      color: gold;
      text-shadow: 0 0 5px rgba(0,0,0,0.5);
    }
    
    .voucher-details {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    
    .voucher-discount {
      font-weight: bold;
      color: #ffcc00;
    }
    
    .voucher-date {
      font-size: 0.9rem;
      color: #ccc;
    }
    
    .voucher-message {
      margin-bottom: 15px;
      text-align: center;
    }
    
    .copy-btn {
        background: none;
        border: 1px solid gold;
        color: gold;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        margin-left: 10px;
    }
    
    /* Report card styles */
    .report-card {
      background: var(--card-bg);
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-left: 4px solid var(--primary-color);
    }
    
    .report-card.penalty {
      border-left-color: var(--secondary-color);
    }
    
    .report-card h4 {
      margin-top: 0;
      color: var(--primary-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .report-card.penalty h4 {
      color: var(--secondary-color);
    }
    
    .report-card .meta {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .report-card .status {
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.85rem;
    }
    
    .status-pending {
      background: rgba(255, 193, 7, 0.2);
      color: var(--warning-color);
    }
    
    .status-in-progress {
      background: rgba(23, 162, 184, 0.2);
      color: #17a2b8;
    }
    
    .status-resolved {
      background: rgba(40, 167, 69, 0.2);
      color: var(--success-color);
    }
    
    .status-rejected {
      background: rgba(220, 53, 69, 0.2);
      color: var(--danger-color);
    }
    
    .report-card .actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .no-vouchers {
      text-align: center;
      padding: 20px;
      color: rgba(255, 255, 255, 0.5);
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      body {
        font-size: 0.95rem;
      }
      .container {
        padding: 1rem;
      }
      header h1 {
        font-size: 2rem;
      }
      .section {
        padding: 1.5rem;
      }
      .section-title {
        font-size: 1.5rem;
      }
      .form-row {
        flex-direction: column;
        gap: 1rem;
      }
      .merchant-list-container {
        grid-template-columns: 1fr;
      }
      .merchant-card {
        padding: 1rem;
      }
      .merchant-card h3 {
        font-size: 1.1rem;
      }
      .voucher-details,
      .voucher-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      .voucher-code {
        font-size: 1.5rem;
      }
      .btn {
        padding: 10px 20px;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      body {
        font-size: 0.9rem;
      }
      header h1 {
        font-size: 1.8rem;
      }
      .section {
        padding: 1rem;
      }
      .section-title {
        font-size: 1.3rem;
      }
      .form-group input,
      .form-group textarea,
      .form-group select {
        padding: 10px;
        font-size: 0.9rem;
      }
      .voucher-code {
        font-size: 1.2rem;
      }
      .voucher-type {
        font-size: 0.75rem;
      }
      .voucher-discount,
      .voucher-date {
        font-size: 0.8rem;
      }
      .btn {
        padding: 8px 15px;
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body class="is-preload">
  <div id="bg"></div>
  
  <div class="container">
    <header>
      <h1><i class="fas fa-store"></i> সাপোর্ট সেন্টার</h1>
      <p>ইস্যু বিহীন মার্চেন্ট খুঁজুন এবং পেনাল্টি সমস্যা রিপোর্ট করুন</p>
    </header>
    
    <div class="loading-overlay">
      <i class="fas fa-spinner fa-spin fa-3x"></i>
      <p>আপনার অনুরোধ প্রক্রিয়া করা হচ্ছে...</p>
    </div>
    
    <!-- Alert messages container -->
    <div id="alert-container"></div>

    <button type="button" class="btn btn-full" onclick="loadUserReports()" style="margin-bottom: 20px;">
      <i class="fas fa-sync-alt"></i> আমার রিপোর্ট এবং ভাউচার আপডেট করুন
    </button>

    <!-- Vouchers Section -->
    <section class="section" id="vouchers-section" style="display: none;">
      <h2 class="section-title"><i class="fas fa-ticket-alt"></i> আপনার ভাউচার</h2>
      <div id="vouchers-container">
        <!-- Vouchers will be loaded here dynamically -->
      </div>
    </section>
    
    <!-- Issueless Merchants Section -->
    <section class="section">
      <h2 class="section-title"><i class="fas fa-check-circle"></i> ইস্যু বিহীন মার্চেন্টস </h2>
      <p>এই পেইজ গুলো ওয়ান'এআই কোনরূপ পেনাল্টি/ইস্যু মুক্ত বলে যাচাই করেছে।এইসকল পেইজএর কোন ইস্যু দেওয়ার রেকর্ড পাওয়াযায় নি। পূর্ববর্তী রেকর্ড থেকে যাচাই করে ওয়ান এআই এই পেইজ গুলোকে ইস্যুলেস হিসেবে ডিটেক্ট করেছে।</p>
      
      <div class="merchant-list-container" id="issueless-container">
        <!-- Dynamic content will be inserted here -->
      </div>
    </section>
    
    <!-- Issue Reporting Section -->
    <section class="section">
      <h2 class="section-title"><i class="fas fa-bug"></i> মার্চেন্ট রিপোর্ট দিনঃ </h2>
      <p>আপনার অভিজ্ঞতা থেকে ইস্যু বিহীন মার্চেন্ট ও ইস্যু প্রদানকারী মার্চেন্টদের বিস্তারিত প্রদান করে ডিস্কাউন্ট ভাউচার ও কুপন জিতে নিনঃ </p>
    
      <form id="issue-report-form">
        <div class="form-row">
          <div class="form-group">
            <label for="issue-merchant-name">পেইজের নাম</label>
            <input type="text" id="issue-merchant-name" name="merchantName" 
                   placeholder="মার্চেন্টের নাম লিখুন" required>
          </div>
          <div class="form-group">
            <label for="issue-merchant-phone">মার্চেন্ট ফোন নম্বর</label>
            <input type="tel" id="issue-merchant-phone" name="merchantPhone" 
                   pattern="01[3-9]\d{8}" 
                   placeholder="01XXXXXXXXX" required>
          </div>
        </div>
        
        <div class="form-group">
          <label for="issue-type">পেইজের ধরন</label>
          <select id="issue-type" name="issueType" required>
            <option value="">মার্চেন্ট টাইপ নির্বাচন করুন</option>
            <option value="issue-raising">ইস্যু প্রদান করবে</option>
            <option value="issue-less">ইস্যু বিহীন এবং নোরেস্পন্স</option>
            <option value="other">অন্যান্য</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="issue-details">সমস্যার বিস্তারিত বিবরণ</label>
          <textarea id="issue-details" name="issueDetails" 
                    placeholder="সমস্যার বিস্তারিত বর্ণনা দিন" required></textarea>
        </div>
        
        <button type="submit" class="btn btn-full">
          <i class="fas fa-paper-plane"></i> মার্চেন্ট রিপোর্ট জমা দিন
        </button>
      </form>
    </section>
    
    <!-- Confirmation messages container -->
    <div id="confirmation-container" style="position: fixed; top: 20px; right: 20px; z-index: 9999;"></div>
    
    <!-- Penalty Support Section -->
    <section class="section">
      <h2 class="section-title"><i class="fas fa-exclamation-triangle"></i> পেনাল্টি সাপোর্ট</h2>
      <p>মার্চেন্টের কাছ থেকে পেনাল্টি পেলে রিপোর্ট করুন এবং ভাউচার পান</p>
      
      <form id="penalty-report-form">
        <div class="form-row">
          <div class="form-group">
            <label for="merchant-name">মার্চেন্ট/পেইজের নাম</label>
            <input type="text" id="merchant-name" name="merchantName" 
                   placeholder="মার্চেন্টের নাম লিখুন" required>
          </div>
          <div class="form-group">
            <label for="customer-name">গ্রাহকের নাম</label>
            <input type="text" id="customer-name" name="customerName" 
                   placeholder="গ্রাহকের নাম লিখুন" required>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="customer-phone">গ্রাহকের ফোন নম্বর</label>
            <input type="tel" id="customer-phone" name="customerPhone" 
                   pattern="01[3-9]\d{8}" 
                   placeholder="01XXXXXXXXX" required>
          </div>
          <div class="form-group">
            <label for="penalty-date">পেনাল্টির তারিখ</label>
            <input type="date" id="penalty-date" name="penaltyDate" required>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="amount1">আসল টাকার পরিমাণ</label>
            <input type="number" id="amount1" name="amount1" 
                   placeholder="আসল টাকার পরিমাণ" required>
          </div>
          <div class="form-group">
            <label for="amount2">পরিবর্তিত টাকার পরিমাণ</label>
            <input type="number" id="amount2" name="amount2" 
                   placeholder="পরিবর্তিত টাকার পরিমাণ" required>
          </div>
        </div>
        
        <div class="form-group">
          <label for="penalty-details">সমস্যার বিস্তারিত বিবরণ</label>
          <textarea id="penalty-details" name="penaltyDetails" 
                    placeholder="পেনাল্টির বিস্তারিত বর্ণনা দিন" required></textarea>
        </div>
        
        <button type="submit" class="btn btn-full">
          <i class="fas fa-paper-plane"></i> রিপোর্ট জমা দিন
        </button>
      </form>
    </section>
    
    <!-- Premium Service Section -->
    <section class="section">
      <h2 class="section-title"><i class="fas fa-crown"></i> প্রিমিয়াম মার্চেন্ট ডাটাবেস</h2>
      <p>আমাদের যাচাইকৃত মার্চেন্ট ডাটাবেসে সম্পূর্ণ অ্যাক্সেস পান</p>
      
      <form id="premium-service-form">
        <div class="form-row">
          <div class="form-group">
            <label for="scope-phone">হোয়াটসঅ্যাপ নম্বর</label>
            <input type="tel" id="scope-phone" name="phone" 
                   pattern="01[3-9]\d{8}" 
                   placeholder="01XXXXXXXXX" required>
          </div>
          <div class="form-group">
            <label for="scope-trxid">পেমেন্ট TRX ID</label>
            <input type="text" id="scope-trxid" name="trxid" 
                   minlength="8" placeholder="আপনার পেমেন্ট TRX ID লিখুন" required>
          </div>
        </div>
        
        <div class="form-group">
          <label for="scope-amount">প্যাকেজ নির্বাচন করুন</label>
          <select id="scope-amount" name="amount" required>
            <option value="">প্যাকেজ নির্বাচন করুন</option>
            <option value="500">15 দিন + 15 মার্চেন্ট (500 BDT)</option>
            <option value="1000">1 মাস + 30 মার্চেন্ট (1000 BDT)</option>
            <option value="2000">3 মাস + সম্পূর্ণ ডাটাবেস (2000 BDT)</option>
            <option value="5000">লাইফটাইম + সম্পূর্ণ ডাটাবেস (5000 BDT)</option>
          </select>
        </div>
        
        <button type="submit" class="btn btn-secondary btn-full">
          <i class="fas fa-lock"></i> প্রিমিয়াম অ্যাক্সেস পান
        </button>
      </form>
    </section>
  </div>

  <script>
    // Merchant data
    const merchantData = {
      issueless: [
        "ApoonShop.com", "Arogga", "BD Beponi", "Believers Shop", "Daily Buy BD", 
        "Deen Fashion2", "Delux Shop", "Dream Heaven", "EZICLICK", "Edaza BD",
        "Fabrilife", "Giftbd.com", "HT Bazar", "Haramin Store", "Head Gear",
        "La'am", "LS Online", "Manzile BD", "Maxfit Food", "Mehendi By MiMi",
        "My Bazar BD", "Noba Global", "Online Shopping", "Organic Plus",
        "Renix Unani Labrotories Limited", "Robi Shop BD", "Shopno Mart",
        "Sunnah Sqr", "Tanhas Collection", "Tasnim Aurthy", "US Bangla Bazar BD",
        "XPRESS IN TOWN", "e-cart.com.bd", "Malihas Room"
      ],
      issueProne: []
    };

    // Initialize loading overlay
    const loadingOverlay = document.querySelector('.loading-overlay');

    // Display merchants in the UI
    function displayMerchants() {
      const container = document.getElementById('issueless-container');
      if (!container) {
        console.error('Error: #issueless-container not found.');
        return;
      }
      container.innerHTML = '';
      
      const chunkSize = 8;
      if (merchantData.issueless && merchantData.issueless.length > 0) {
        for (let i = 0; i < merchantData.issueless.length; i += chunkSize) {
          const chunk = merchantData.issueless.slice(i, i + chunkSize);
          
          const card = document.createElement('div');
          card.className = 'merchant-card';
          card.innerHTML = `
            <h3>মার্চেন্ট তালিকা <span class="status issueless">Issue-Less-Safe</span></h3>
            <ul>
              ${chunk.map(merchant => `<li>${merchant}</li>`).join('')}
            </ul>
          `;
          
          container.appendChild(card);
        }
      } else {
        container.innerHTML = '<p>কোন ইস্যু বিহীন মার্চেন্ট পাওয়া যায়নি।</p>';
      }
    }

    // Show confirmation message
    function showConfirmation(message, isSuccess = true) {
      const container = document.getElementById('confirmation-container');
      const messageDiv = document.createElement('div');
      
      messageDiv.className = `confirmation-message ${isSuccess ? 'confirmation-success' : 'confirmation-error'}`;
      messageDiv.innerHTML = `
        <i class="fas ${isSuccess ? 'fa-check-circle' : 'fa-exclamation-circle'} confirmation-icon"></i>
        ${message}
      `;
      
      container.appendChild(messageDiv);
      
      // Auto remove after 5 seconds
      setTimeout(() => {
        messageDiv.classList.add('fade-out');
        setTimeout(() => messageDiv.remove(), 1000);
      }, 5000);
    }

    // Format date to readable string
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('bn-BD', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      });
    }

    // Load user reports and vouchers
    async function loadUserReports() {
      let phone = localStorage.getItem('lastCheckedPhone');
      if (!phone) {
        phone = prompt("আপনার রিপোর্ট দেখতে আপনার ফোন নম্বর দিন:");
        if (!phone) return;
        localStorage.setItem('lastCheckedPhone', phone);
      }
      
      loadingOverlay.style.display = 'flex';
      document.getElementById('vouchers-section').style.display = 'none'; // Hide initially
      try {
        // Fetch user vouchers
        const vouchersResponse = await fetch(`https://oneai-wjox.onrender.com/vouchers/${phone}`);
        const vouchersData = await vouchersResponse.json();
        
        if (vouchersResponse.ok && vouchersData.success) {
          // Filter out used or expired vouchers
          const activeVouchers = vouchersData.vouchers.filter(voucher => {
            if (voucher.isUsed) return false;
            if (voucher.validUntil && new Date(voucher.validUntil) < new Date()) return false;
            return true;
          });
          displayVouchers(activeVouchers);
        } else {
          showConfirmation(vouchersData.message || 'ভাউচার লোড করতে সমস্যা হয়েছে', false);
        }
      } catch (error) {
        showConfirmation('নেটওয়ার্ক ত্রুটি হয়েছে, আবার চেষ্টা করুন', false);
      } finally {
        loadingOverlay.style.display = 'none';
      }
    }

    // Display vouchers
    function displayVouchers(vouchers) {
      const container = document.getElementById('vouchers-container');
      container.innerHTML = '';
      
      if (vouchers.length === 0) {
        container.innerHTML = '<p class="no-vouchers">কোন ভাউচার পাওয়া যায়নি</p>';
      } else {
        vouchers.forEach(voucher => {
          const voucherElement = document.createElement('div');
          voucherElement.className = 'voucher-container';
          
          const isPremium = voucher.reportModel === 'PremiumService';

          let expiryDate = 'N/A';
          if (voucher.validUntil) {
              expiryDate = formatDate(voucher.validUntil)
          }

          voucherElement.innerHTML = `
            <div class="voucher-header">
              <h3><i class="fas fa-gift"></i> ${isPremium ? 'প্রিমিয়াম অ্যাক্সেস ভাউচার' : 'ডিসকাউন্ট ভাউচার'}</h3>
              <span class="voucher-type ${isPremium ? 'issue' : 'penalty'}">${isPremium ? 'প্রিমিয়াম' : 'ডিসকাউন্ট'}</span>
            </div>
            <div class="voucher-message">আপনার ভাউচার কোড:</div>
            <div class="voucher-code">${voucher.code} <button class="copy-btn" onclick="copyVoucher('${voucher.code}')"><i class="fas fa-copy"></i></button></div>
            <div class="voucher-details">
              <div class="voucher-discount"><i class="fas fa-tag"></i> ডিসকাউন্ট: ${voucher.discountPercentage}%</div>
              <div class="voucher-date"><i class="fas fa-calendar"></i> মেয়াদ শেষ হবে: ${expiryDate}</div>
            </div>
          `;
          
          container.appendChild(voucherElement);
        });
      }

      if (vouchers.length > 0) {
        document.getElementById('vouchers-section').style.display = 'block';
      }
    }

    function copyVoucher(code) {
        navigator.clipboard.writeText(code).then(() => {
            showConfirmation('ভাউচার কোড কপি করা হয়েছে!');
        }, () => {
            showConfirmation('ভাউচার কোড কপি করতে সমস্যা হয়েছে', false);
        });
    }

    // Submit merchant issue report
    async function submitMerchantIssue(event) {
      event.preventDefault();
      loadingOverlay.style.display = 'flex';
      
      const formData = {
        merchantName: document.getElementById('issue-merchant-name').value,
        merchantPhone: document.getElementById('issue-merchant-phone').value,
        issueType: document.getElementById('issue-type').value,
        details: document.getElementById('issue-details').value
      };
      
      try {
        const response = await fetch('https://oneai-wjox.onrender.com/merchant-issues', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          showConfirmation('আপনার ইস্যু রিপোর্ট সফলভাবে জমা হয়েছে!');
          
          const whatsappMessage = `
New Merchant Issue Report:
-------------------------
Page Name: ${formData.merchantName}
Merchant Phone: ${formData.merchantPhone}
Page Type: ${formData.issueType}
Details: ${formData.details}
`;
          window.open(`https://wa.me/8801568760780?text=${encodeURIComponent(whatsappMessage)}`, '_blank');

          document.getElementById('issue-report-form').reset();
          localStorage.setItem('lastCheckedPhone', formData.merchantPhone);
          loadUserReports();
        } else {
          showConfirmation(data.message || 'রিপোর্ট জমা দিতে সমস্যা হয়েছে', false);
        }
      } catch (error) {
        showConfirmation('নেটওয়ার্ক ত্রুটি হয়েছে, আবার চেষ্টা করুন', false);
      } finally {
        loadingOverlay.style.display = 'none';
      }
    }

    // Submit penalty report
    async function submitPenaltyReport(event) {
      event.preventDefault();
      loadingOverlay.style.display = 'flex';
      
      const formData = {
        merchantName: document.getElementById('merchant-name').value,
        customerName: document.getElementById('customer-name').value,
        customerPhone: document.getElementById('customer-phone').value,
        penaltyDate: document.getElementById('penalty-date').value,
        amount1: parseFloat(document.getElementById('amount1').value),
        amount2: parseFloat(document.getElementById('amount2').value),
        penaltyDetails: document.getElementById('penalty-details').value
      };
      
      try {
        const response = await fetch('https://oneai-wjox.onrender.com/penalty-report', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          showConfirmation('আপনার পেনাল্টি রিপোর্ট সফলভাবে জমা হয়েছে!');

          const whatsappMessage = `
New Penalty Report:
-------------------
Merchant Name: ${formData.merchantName}
Customer Name: ${formData.customerName}
Customer Phone: ${formData.customerPhone}
Penalty Date: ${formData.penaltyDate}
Original Amount: ${formData.amount1}
Changed Amount: ${formData.amount2}
Details: ${formData.penaltyDetails}
`;
          window.open(`https://wa.me/8801568760780?text=${encodeURIComponent(whatsappMessage)}`, '_blank');

          document.getElementById('penalty-report-form').reset();
          localStorage.setItem('lastCheckedPhone', formData.customerPhone);
          loadUserReports();
        } else {
          showConfirmation(data.message || 'রিপোর্ট জমা দিতে সমস্যা হয়েছে', false);
        }
      } catch (error) {
        showConfirmation('নেটওয়ার্ক ত্রুটি হয়েছে, আবার চেষ্টা করুন', false);
      } finally {
        loadingOverlay.style.display = 'none';
      }
    }

    // Submit premium service request
    async function submitPremiumService(event) {
      event.preventDefault();
      loadingOverlay.style.display = 'flex';
      
      const formData = {
        phone: document.getElementById('scope-phone').value,
        trxid: document.getElementById('scope-trxid').value,
        amount: document.getElementById('scope-amount').value
      };

      try {
        const response = await fetch('https://oneai-wjox.onrender.com/premium-service', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
          showConfirmation('প্রিমিয়াম সার্ভিস অনুরোধ সফলভাবে জমা হয়েছে!');
          
          const whatsappMessage = `
New Premium Service Request:
----------------------------
Phone: ${formData.phone}
TRX ID: ${formData.trxid}
Amount: ${formData.amount}
`;
          window.open(`https://wa.me/8801568760780?text=${encodeURIComponent(whatsappMessage)}`, '_blank');

          document.getElementById('premium-service-form').reset();
        } else {
          showConfirmation(data.message || 'অনুরোধ জমা দিতে সমস্যা হয়েছে', false);
        }
      } catch (error) {
        showConfirmation('নেটওয়ার্ক ত্রুটি হয়েছে, আবার চেষ্টা করুন', false);
      } finally {
        loadingOverlay.style.display = 'none';
      }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', () => {
      displayMerchants();
      
      const issueForm = document.getElementById('issue-report-form');
      if (issueForm) {
        issueForm.addEventListener('submit', submitMerchantIssue);
      }
      
      const penaltyForm = document.getElementById('penalty-report-form');
      if (penaltyForm) {
        penaltyForm.addEventListener('submit', submitPenaltyReport);
      }
      
      const premiumForm = document.getElementById('premium-service-form');
      if (premiumForm) {
        premiumForm.addEventListener('submit', submitPremiumService);
      }
      
      // Automatically load reports if phone number is in local storage
      if (localStorage.getItem('lastCheckedPhone')) {
        loadUserReports();
      }
    });
  </script>
  
  <!-- Include scripts -->
  <script src="./assets/js/hackeranimation.js"></script>
  <script src="./assets/js/main.js"></script>
  <script src="./assets/js/load-navbar.js"></script>
</body>
</html>
