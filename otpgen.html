<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>1ai Payment Gateway</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="./assets/css/main.css">
  <style>
    /* Add responsive table styles */
    .status-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 0.9em;
      min-width: 300px;
      overflow-x: auto;
      display: block;
    }

    .status-table th,
    .status-table td {
      padding: 12px 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    .status-table th {
      background-color: #f5f5f5;
    }

    .status-badge {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8em;
      text-align: center;
      display: inline-block;
    }

    .status-pending { background: #fff3cd; color: #856404; }
    .status-completed { background: #d4edda; color: #155724; }
    .status-failed { background: #f8d7da; color: #721c24; }

    @media (max-width: 480px) {
      .status-table {
        font-size: 0.8em;
      }
      
      .status-table th,
      .status-table td {
        padding: 8px 4px;
      }
      
      .status-badge {
        padding: 3px 6px;
      }
    }

    /* Mobile-first responsive design */
    .consignment-group {
      position: relative;
      padding: 15px;
      border: 1px solid #eee;
      margin-bottom: 15px;
      border-radius: 8px;
    }

    .remove-consignment {
      position: absolute;
      top: 5px;
      right: 5px;
      cursor: pointer;
      color: #dc3545;
      font-weight: bold;
    }
  </style>
</head>
<body class="is-preload">
  <div id="bg"></div>
  <h1>AI Payment Processor</h1>

  <header id="header">
    <h3>Bulk Service Payment</h3>
    <p>বিস্তারিত পূরণের পর পেমেন্ট এর পূর্বে ডিস্কাউন্ট বাটনে ক্লিক করে জিতেনিন ৪০% পর্যন্ত আকর্ষনীয় নগদ ডিসকাউন্ট </p>
  </header>

  <section>
    <!-- Existing payment form remains the same -->

    <h3>Payment Status</h3>
    <div id="status-container">
      <table class="status-table">
        <thead>
          <tr>
            <th>TRX ID</th>
            <th>Amount</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="status-body">
          <!-- Status rows will be dynamically added here -->
        </tbody>
      </table>
    </div>

    <div id="confirmation-message" style="margin-top: 20px;"></div>
  </section>

  <script>
    // WebSocket connection for real-time updates
    const ws = new WebSocket('wss://oneai-wjox.onrender.com');
    
    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);
      if(data.type === 'statusUpdate') {
        updatePaymentStatus(data.payment);
      }
    };

    function updatePaymentStatus(payment) {
      const row = document.querySelector(`tr[data-trxid="${payment.trxid}"]`);
      if(row) {
        row.querySelector('.status-badge').className = `status-badge status-${payment.status}`;
        row.querySelector('.status-badge').textContent = payment.status;
      }
    }

    function createStatusRow(payment) {
      const row = document.createElement('tr');
      row.setAttribute('data-trxid', payment.trxid);
      
      row.innerHTML = `
        <td>${payment.trxid}</td>
        <td>৳${payment.amount.toFixed(2)}</td>
        <td>${new Date(payment.timestamp).toLocaleDateString()}</td>
        <td>
          <span class="status-badge status-${payment.status}">
            ${payment.status}
          </span>
        </td>
      `;
      
      return row;
    }

    // Load initial payment status
    function loadPaymentHistory() {
      const history = JSON.parse(localStorage.getItem('paymentHistory') || []);
      const tbody = document.getElementById('status-body');
      tbody.innerHTML = '';
      
      history.forEach(payment => {
        tbody.appendChild(createStatusRow(payment));
      });
    }

    // Update form submit handler
    document.getElementById('payment-form').addEventListener('submit', async (e) => {
      // ... existing submit logic ...

      try {
        // ... existing payment processing ...

        // Add to payment history
        const paymentRecord = {
          trxid: formData.trxid,
          amount: formData.amount3,
          status: 'pending',
          timestamp: Date.now()
        };

        let history = JSON.parse(localStorage.getItem('paymentHistory') || '[]');
        history = [paymentRecord, ...history].slice(0, 5); // Keep last 5 records
        localStorage.setItem('paymentHistory', JSON.stringify(history));

        // Add to status table
        document.getElementById('status-body').prepend(createStatusRow(paymentRecord));
        
      } catch (error) {
        // ... existing error handling ...
      }
    });

    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      loadPaymentHistory();
      // ... existing initialization ...
    });
  </script>

  <!-- Rest of the existing script remains the same -->
</body>
</html>
